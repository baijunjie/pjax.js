/*! Pjax v1.2.1 | @author baijunjie */
!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):(t.bjj=t.bjj||{},t.bjj.Pjax=e(t.jQuery))}(this,function(t){"use strict";function e(t){t.sort(function(t,e){return-(t.layer-e.layer)})}function n(t,e,n){j&&(d(),e?history.replaceState(t,null,n?null:t):history.pushState(t,null,n?null:t))}function r(e,n,r){if(e&&n&&r){var a=t(e),o=i(a,r);o&&(a.removeClass(n),o.addClass(n))}}function i(e,n){var r=s(n),i=null;return e.each(function(e,n){o(n.getAttribute("href"))||s(n.href)!==r||(i=i?i.add(n):t(n))}),i}function a(t,e,n){var r=s(e);for(var i in t)if(s(i)===r){delete t[i];break}t[e]=n}function o(t){return!t||0===t.indexOf("#")||0===t.indexOf("javascript:")}function c(t){return t&&(0===t.indexOf("http")||0===t.indexOf("file:"))}function l(){return location.protocol+"//"+location.host}function s(t){return t?t.replace(/#.*$/,""):location.protocol+"//"+location.host+location.pathname}function u(t){return t.replace(/[^\/]*$/,"")}function f(t,e){if(e.indexOf("../"))e.indexOf("./")?e.indexOf("/")||(t=l()):e=e.replace("./","");else{var n=0;if(e=e.replace("../",function(){return n=1,t=t.replace(/[^\/]*\/?$/,""),""}),n)return f(t,e)}return t+e}function p(t,e){if(!C){var n=t.filter("[href],[src]").add(t.find("[href],[src]")),r=u(e);n.each(function(t,e){var n=e.getAttribute("href"),i=e.getAttribute("src");o(n)||c(n)||(e.href=f(r,n)),o(i)||c(i)||(e.src=f(r,i))})}}function d(){h(L,!0)}function h(t,e){var n=t.scrollTop;if(t.scrollTop+=n>0?-1:1,t.scrollTop!=n)return t.scrollTop=n,!0;if(e){var r=t.scrollLeft;return t.scrollLeft+=r>0?-1:1,t.scrollLeft!=r?(t.scrollLeft=r,!0):void 0}}function v(t){if("string"!=typeof t||-1==t.indexOf("<script"))return t;var e=/<script[^\>]*?>[^\x00]*?<\/script>/gi;return t.replace(e,"")}function y(n,r){for(var i=new RegExp("<head[^>]*?>([^\x00]*?)</head>","i"),o=new RegExp("<body[^>]*?>([^\x00]*?)</body>","i"),c=v(i.exec(n)),l=v(o.exec(n)),s=c?t(c[1]):null,u=l?t(l[1]):null,f=s?t("<div>").append(s):null,d=u?t("<div>").append(u):null,h=S.pjaxOptions,y={},m=[],A=[],x=[],g=[],b=[],C={},j=0,L=h.length;L>j;j++){var O=h[j];O.script&&x.push(f.find(O.script).add(d.find(O.script)));for(var w,k=0;w=O.container[k++];)if(!C[w]){m.push(j),A.push(t(w).parents().length),b.push(w);var q;q="head"===w?f:"body"===w?d:d.find(w),q.length?p(q,r):q=t(w),g.push(q),C[w]=!0}}for(var E=[],L=A.length;L--;)E.push({id:m[L],layer:A[L],$container:g[L],containerSelector:b[L]});e(E),y.updateList=E,y.href=r,y.title=f.children("title").text(),y.script=x,a(S,r,y)}function m(n,r,i,a,o,c,l,s){var u=s.active,f=s.activeClass,p=s.update,d=s.complete,h=t.isArray(a),y=t.isArray(o),m=t.isArray(c),x=t.isArray(l),g=k++;n=t.map(n.split(","),function(e){return t.trim(e)}),r=t.map(r.split(","),function(e){return t.trim(e)}),S.pjaxOptions[g]={container:n,script:i,active:u,activeClass:f,updateCallback:p,completeCallback:d};t:for(var b,C=0;b=n[C++];){for(var j=0,L=q.updateList.length;L>j;j++)if(b===q.updateList[j].containerSelector)continue t;var w=t(b);q.updateList.push({id:g,layer:w.parents().length,$container:w.clone().html(v(w.html())),containerSelector:b})}if(e(q.updateList),q.script[g]=t(i),r.length)for(var C=0,L=r.length;L>C;C++)r[C]&&O.on("click",r[C],t.proxy(A,null,h?a[C]:a,y?o[C]:o,m?c[C]:c,x?l[C]:l,s,n))}function A(t,e,r,i,a,c,l){var s=this.href;if(!o(this.getAttribute("href")))if(l.preventDefault(),!t&&s in S){var u=S[s];if(u===q)return;x(u,c,i),n(s,e,r)}else g.call(a,this,s,c,e,r,i)}function x(e,n,i){for(var a=e.updateList.length,o=[];a--;){var c=e.updateList[a],l=c.containerSelector;if(!(t.isArray(n)&&t.inArray(l,n)<0)){var s=t(l),u=c.$container.clone();if(s.length&&u.length&&s.html()!==u.html()){var f=c.id,p=S.pjaxOptions[f];p.updateCallback.call(s[0],s,u,e.href),(!i||t.isArray(i)&&!i[t.inArray(l,n)])&&s.empty(),u.each(function(t){u.eq(t).children().stop().css("opacity",0).appendTo(s.eq(t)).animate({opacity:1})}),p.completeCallback.call(s[0],s,u,e.href),o[f]=!0}}}if(o.length){e.title&&(document.title=e.title);var d={};for(a=S.pjaxOptions.length;a--;)if(o[a]){var p=S.pjaxOptions[a];d[p.active+p.activeClass]||(r(p.active,p.activeClass,e.href),d[p.active+p.activeClass]=!0);var h=e.script&&e.script[a];h&&(w.append(h),h.remove())}q=e}}function g(e,r,i,a,o,c){var l=this;l.load.call(e,r),t.ajax({url:r,type:"GET",context:this,beforeSend:function(t){t.setRequestHeader("X-PJAX",!0),t.setRequestHeader("X-PJAX-Container",JSON.stringify(i))}}).done(function(t){y(t,r);var s=S[r];x(s,i,c),n(r,a,o),l.done.call(e,r,t)}).fail(function(){l.fail.call(e,r,i)})}function b(){this._init.apply(this,arguments)}var C,j=!!window.history.pushState,L=h(document.documentElement)?document.documentElement:document.body,O=(t(window),t(document)),w=t(document.body),S={},k=0,q={},E={container:"head,body",link:"",script:"",active:"",activeClass:"active",noCache:!1,noHistory:!1,noChangeURL:!1,pile:!1,noConvertPath:!1,load:function(){},done:function(){},fail:function(){},update:function(){},complete:function(){}},T=b.prototype;return T.constructor=b,T._init=function(e){var i=t.extend({},E,e),o=i.container,c=i.link,l=i.script,s=i.noCache,u=i.noHistory,f=i.noChangeURL,h=i.pile;C=i.noConvertPath,k||(p(t(document.documentElement),location.href),q={href:location.href,title:document.title,updateList:[],script:[]},S.pjaxOptions=[],a(S,location.href,q),n(location.href,!0),j&&window.addEventListener("popstate",function(t){var e=t.state;e&&e in S&&x(S[e]),window.setTimeout(d,0)},!1)),r(i.active,i.activeClass,location.href),o=t.isArray(o)?o:[o],c=t.isArray(c)?c:[c],l=t.isArray(l)?l:[l],s=t.isArray(s)?t.isArray(s[0])?s:[s]:s,u=t.isArray(u)?t.isArray(u[0])?u:[u]:u,f=t.isArray(f)?t.isArray(f[0])?f:[f]:f,h=t.isArray(h)?t.isArray(h[0])?t.isArray(h[0][0])?h:[h]:[[h]]:h;for(var v=t.isArray(s),y=t.isArray(u),A=t.isArray(f),g=t.isArray(h),b=0,L=o.length;L>b;b++)m(o[b],c[b],l[b],v?s[b]:s,y?u[b]:u,A?f[b]:f,g?h[b]:h,i);this.options=i},T.update=function(e,n,r,i,a){n=t.map(n.split(","),function(e){return t.trim(e)}),g.call(this.options,null,e,n,r,i,a)},b});